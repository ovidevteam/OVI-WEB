import{_ as J,r as u,a as Y,A as Z,C as ee,c as h,b as y,d as a,a1 as le,w as t,j as A,a3 as ae,q as te,E as ne,a4 as oe,B as _,a6 as ue,f as se,G as ie,o as d,p as r,h as de,i as re,aa as pe,F as me,P as D,Q as U,R as ce,T as fe,W as ge,x as ve,aT as he,al as ye,aG as _e,aS as be,y as L}from"./index-WXSJfKjD.js";/* empty css                   *//* empty css                       *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                        *//* empty css                    */import{d as b}from"./doctorService-3iRsubus.js";import{d as Ve}from"./departmentService-CYi6ROd7.js";const Ee={class:"doctor-management"},ke={class:"content-card"},Ce={class:"content-card-header"},Ne={class:"pagination-wrapper"},Te={__name:"DoctorManagement",setup(we){const V=u(!1),E=u(!1),k=u([]),f=u([]),C=u(0),g=u(1),N=u(20),T=u(""),w=u(""),p=u(!1),I=u(null),n=Y({id:null,code:"",fullName:"",specialty:"",departmentId:null,email:"",phone:"",status:"ACTIVE"}),S=Z(()=>!!n.id),R={fullName:[{required:!0,message:"Vui lòng nhập họ tên",trigger:"blur"}],specialty:[{required:!0,message:"Vui lòng chọn chuyên khoa",trigger:"change"}],departmentId:[{required:!0,message:"Vui lòng chọn phòng ban",trigger:"change"}],email:[{type:"email",message:"Email không hợp lệ",trigger:"blur"}]},v=async()=>{V.value=!0;try{const o=await b.getList({keyword:T.value,departmentId:w.value,page:g.value,size:N.value});k.value=o.data||[],C.value=o.total||0}catch{k.value=[{id:1,code:"BS-001",fullName:"BS. Nguyễn Văn A",specialty:"Nội khoa",departmentName:"Nội khoa",email:"bsa@bvyhanoi.vn",phone:"0912345678",status:"ACTIVE"},{id:2,code:"BS-002",fullName:"BS. Trần Thị B",specialty:"Ngoại khoa",departmentName:"Ngoại khoa",email:"bsb@bvyhanoi.vn",phone:"0987654321",status:"ACTIVE"},{id:3,code:"BS-003",fullName:"BS. Lê Văn C",specialty:"Da liễu",departmentName:"Da liễu",email:"bsc@bvyhanoi.vn",phone:"0909090909",status:"ACTIVE"}],C.value=3}finally{V.value=!1}},$=async()=>{try{f.value=await Ve.getActiveList()}catch{f.value=[{id:1,name:"Nội khoa"},{id:2,name:"Ngoại khoa"},{id:3,name:"Da liễu"}]}},P=()=>{g.value=1,v()},M=(o=null)=>{o?Object.assign(n,o):Object.assign(n,{id:null,code:"",fullName:"",specialty:"",departmentId:null,email:"",phone:"",status:"ACTIVE"}),p.value=!0},q=async()=>{if(I.value)try{await I.value.validate(),E.value=!0,S.value?await b.update(n.id,n):await b.create(n),L.success(S.value?"Cập nhật thành công!":"Thêm mới thành công!"),p.value=!1,v()}catch(o){o!==!1&&L.error("Có lỗi xảy ra")}finally{E.value=!1}},F=async o=>{try{await be.confirm(`Bạn có chắc chắn muốn xóa bác sĩ "${o.fullName}"?`,"Xác nhận xóa",{type:"warning"}),await b.delete(o.id),L.success("Đã xóa bác sĩ!"),v()}catch{}};return ee(()=>{v(),$()}),(o,e)=>{const m=te,c=re,s=de,B=ce,x=me,z=ne,i=fe,j=ge,G=ie,O=ue,H=_e,Q=ye,X=se,K=oe;return d(),h("div",Ee,[y("div",ke,[y("div",Ce,[e[15]||(e[15]=y("h3",{class:"content-card-title"},"Quản lý Bác sĩ",-1)),a(m,{type:"primary",icon:A(ae),onClick:e[0]||(e[0]=l=>M())},{default:t(()=>[...e[14]||(e[14]=[r(" Thêm mới ",-1)])]),_:1},8,["icon"])]),a(z,{inline:!0,class:"filter-form"},{default:t(()=>[a(s,null,{default:t(()=>[a(c,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=l=>T.value=l),placeholder:"Tìm theo tên, mã BS...","prefix-icon":A(pe),clearable:"",style:{width:"250px"},onInput:P},null,8,["modelValue","prefix-icon"])]),_:1}),a(s,null,{default:t(()=>[a(x,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=l=>w.value=l),placeholder:"Phòng ban",clearable:"",onChange:P},{default:t(()=>[(d(!0),h(D,null,U(f.value,l=>(d(),_(B,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),le((d(),_(G,{data:k.value,stripe:""},{default:t(()=>[a(i,{prop:"code",label:"Mã BS",width:"100"}),a(i,{prop:"fullName",label:"Họ tên","min-width":"180"}),a(i,{prop:"specialty",label:"Chuyên khoa",width:"150"}),a(i,{prop:"departmentName",label:"Phòng ban",width:"150"}),a(i,{prop:"email",label:"Email","min-width":"180"}),a(i,{prop:"phone",label:"Số điện thoại",width:"130"}),a(i,{prop:"status",label:"Trạng thái",width:"110",align:"center"},{default:t(({row:l})=>[a(j,{type:l.status==="ACTIVE"?"success":"info",size:"small"},{default:t(()=>[r(ve(l.status==="ACTIVE"?"Hoạt động":"Ngừng"),1)]),_:2},1032,["type"])]),_:1}),a(i,{label:"Thao tác",width:"150",align:"center",fixed:"right"},{default:t(({row:l})=>[a(m,{type:"primary",link:"",onClick:W=>M(l)},{default:t(()=>[...e[16]||(e[16]=[r("Sửa",-1)])]),_:1},8,["onClick"]),a(m,{type:"danger",link:"",onClick:W=>F(l)},{default:t(()=>[...e[17]||(e[17]=[r("Xóa",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,V.value]]),y("div",Ne,[a(O,{"current-page":g.value,"onUpdate:currentPage":e[3]||(e[3]=l=>g.value=l),"page-size":N.value,"onUpdate:pageSize":e[4]||(e[4]=l=>N.value=l),total:C.value,layout:"total, prev, pager, next"},null,8,["current-page","page-size","total"])])]),a(X,{modelValue:p.value,"onUpdate:modelValue":e[13]||(e[13]=l=>p.value=l),title:S.value?"Sửa Bác sĩ":"Thêm Bác sĩ",width:"500px","close-on-click-modal":!1},{footer:t(()=>[a(m,{onClick:e[12]||(e[12]=l=>p.value=!1)},{default:t(()=>[...e[20]||(e[20]=[r("Hủy",-1)])]),_:1}),a(m,{type:"primary",loading:E.value,onClick:q},{default:t(()=>[...e[21]||(e[21]=[r("Lưu",-1)])]),_:1},8,["loading"])]),default:t(()=>[a(z,{ref_key:"formRef",ref:I,model:n,rules:R,"label-width":"120px"},{default:t(()=>[a(s,{label:"Mã bác sĩ"},{default:t(()=>[a(c,{modelValue:n.code,"onUpdate:modelValue":e[5]||(e[5]=l=>n.code=l),placeholder:"Tự động nếu để trống"},null,8,["modelValue"])]),_:1}),a(s,{label:"Họ tên",prop:"fullName"},{default:t(()=>[a(c,{modelValue:n.fullName,"onUpdate:modelValue":e[6]||(e[6]=l=>n.fullName=l)},null,8,["modelValue"])]),_:1}),a(s,{label:"Chuyên khoa",prop:"specialty"},{default:t(()=>[a(x,{modelValue:n.specialty,"onUpdate:modelValue":e[7]||(e[7]=l=>n.specialty=l),placeholder:"Chọn chuyên khoa",style:{width:"100%"}},{default:t(()=>[(d(!0),h(D,null,U(A(he),l=>(d(),_(B,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"Phòng ban",prop:"departmentId"},{default:t(()=>[a(x,{modelValue:n.departmentId,"onUpdate:modelValue":e[8]||(e[8]=l=>n.departmentId=l),placeholder:"Chọn phòng ban",style:{width:"100%"}},{default:t(()=>[(d(!0),h(D,null,U(f.value,l=>(d(),_(B,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"Email",prop:"email"},{default:t(()=>[a(c,{modelValue:n.email,"onUpdate:modelValue":e[9]||(e[9]=l=>n.email=l),type:"email"},null,8,["modelValue"])]),_:1}),a(s,{label:"Số điện thoại"},{default:t(()=>[a(c,{modelValue:n.phone,"onUpdate:modelValue":e[10]||(e[10]=l=>n.phone=l)},null,8,["modelValue"])]),_:1}),a(s,{label:"Trạng thái"},{default:t(()=>[a(Q,{modelValue:n.status,"onUpdate:modelValue":e[11]||(e[11]=l=>n.status=l)},{default:t(()=>[a(H,{value:"ACTIVE"},{default:t(()=>[...e[18]||(e[18]=[r("Hoạt động",-1)])]),_:1}),a(H,{value:"INACTIVE"},{default:t(()=>[...e[19]||(e[19]=[r("Ngừng",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ze=J(Te,[["__scopeId","data-v-60918058"]]);export{ze as default};
