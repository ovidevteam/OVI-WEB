import{_ as W,r as l,z,B as G,c as i,b as t,d as r,A as D,X as x,w as h,C as $,a1 as q,j as u,aN as F,q as K,x as o,J as I,K as N,f as X,g as j,o as n,L as H,p as V,U as J,T as Q,Q as Z,aZ as ee,O as te,e as ae,a_ as se,ak as ne,y as E}from"./index-BgKCwKch.js";/* empty css                 */import{I as oe}from"./ImageGallery-DvHV4AeL.js";/* empty css               *//* empty css                             *//* empty css                  */import{r as le}from"./reportService-XJ75aB6C.js";import{d as ie}from"./departmentService-BzlNGIw4.js";const ce={class:"report-with-images"},re={class:"content-card"},de={class:"content-card-header"},ue={class:"header-actions"},me={class:"stats-row"},he={class:"stat-item"},pe={class:"stat-value"},ve={class:"stat-item"},_e={class:"stat-value"},ge={class:"feedback-grid"},ye=["onClick"],fe={class:"card-header"},ke={class:"feedback-code"},De={class:"card-body"},xe={class:"feedback-content"},Ie={class:"feedback-meta"},Ne={class:"card-images"},Ee={class:"image-grid"},Ve=["onClick"],Ce={key:0,class:"image-overlay"},be={__name:"ReportWithImages",setup(we){const C=j(),p=l(!1),c=l([]),v=l([]),_=l(""),m=l([]),g=l(!1),y=l(null),b=z(()=>c.value.reduce((s,a)=>{var d;return s+(((d=a.images)==null?void 0:d.length)||0)},0)),f=async()=>{var s,a;p.value=!0;try{c.value=await le.getWithImages({departmentId:_.value,startDate:(s=m.value)==null?void 0:s[0],endDate:(a=m.value)==null?void 0:a[1]})}catch{c.value=[{id:1,code:"PA-20251127-001",content:"Phản ánh về thái độ phục vụ của nhân viên khoa Nội khi tiếp nhận bệnh nhân",departmentName:"Nội khoa",receivedDate:"2025-11-27",status:"PROCESSING",images:[{id:1,url:"https://via.placeholder.com/300x200?text=Image+1"},{id:2,url:"https://via.placeholder.com/300x200?text=Image+2"}]},{id:2,code:"PA-20251126-002",content:"Thời gian chờ khám quá lâu tại phòng khám da liễu, cần cải thiện",departmentName:"Da liễu",receivedDate:"2025-11-26",status:"COMPLETED",images:[{id:3,url:"https://via.placeholder.com/300x200?text=Image+3"},{id:4,url:"https://via.placeholder.com/300x200?text=Image+4"},{id:5,url:"https://via.placeholder.com/300x200?text=Image+5"}]},{id:3,code:"PA-20251125-003",content:"Cơ sở vật chất phòng khám cần được nâng cấp để phục vụ bệnh nhân tốt hơn",departmentName:"Ngoại khoa",receivedDate:"2025-11-25",status:"NEW",images:[{id:6,url:"https://via.placeholder.com/300x200?text=Image+6"}]}]}finally{p.value=!1}},w=async()=>{try{v.value=await ie.getActiveList()}catch{v.value=[{id:1,name:"Nội khoa"},{id:2,name:"Ngoại khoa"}]}},T=s=>{C.push(`/feedback/${s}`)},P=(s,a)=>{y.value=s,g.value=!0},M=async()=>{try{E.info("Đang tải... Vui lòng chờ"),E.success("Tải thành công!")}catch{E.error("Tải thất bại!")}};return G(()=>{f(),w()}),(s,a)=>{const d=H,S=$,Y=q,B=K,A=Z,L=se,R=ne,O=X;return n(),i("div",ce,[t("div",re,[t("div",de,[a[4]||(a[4]=t("h3",{class:"content-card-title"},"Báo cáo có Hình ảnh",-1)),t("div",ue,[r(S,{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=e=>_.value=e),placeholder:"Phòng ban",clearable:"",onChange:f},{default:h(()=>[(n(!0),i(I,null,N(v.value,e=>(n(),D(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),r(Y,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),type:"daterange","start-placeholder":"Từ ngày","end-placeholder":"Đến ngày",format:"DD/MM/YYYY","value-format":"YYYY-MM-DD",onChange:f},null,8,["modelValue"]),r(B,{type:"primary",icon:u(F),onClick:M},{default:h(()=>[...a[3]||(a[3]=[V(" Tải tất cả ảnh ",-1)])]),_:1},8,["icon"])])]),t("div",me,[t("div",he,[t("span",pe,o(c.value.length),1),a[5]||(a[5]=t("span",{class:"stat-label"},"Phản ánh có ảnh",-1))]),t("div",ve,[t("span",_e,o(b.value),1),a[6]||(a[6]=t("span",{class:"stat-label"},"Tổng số ảnh",-1))])]),t("div",ge,[(n(!0),i(I,null,N(c.value,e=>(n(),i("div",{key:e.id,class:"feedback-card",onClick:k=>T(e.id)},[t("div",fe,[t("span",ke,o(e.code),1),r(A,{type:u(Q)(e.status),size:"small"},{default:h(()=>[V(o(u(J)(e.status)),1)]),_:2},1032,["type"])]),t("div",De,[t("p",xe,o(u(ee)(e.content,80)),1),t("div",Ie,[t("span",null,o(e.departmentName),1),t("span",null,o(u(te)(e.receivedDate)),1)])]),t("div",Ne,[t("div",Ee,[(n(!0),i(I,null,N(e.images.slice(0,4),(k,U)=>(n(),i("div",{key:k.id,class:"image-item",onClick:ae(Te=>P(e),["stop"])},[r(L,{src:k.url,fit:"cover",lazy:""},null,8,["src"]),U===3&&e.images.length>4?(n(),i("div",Ce," +"+o(e.images.length-4),1)):x("",!0)],8,Ve))),128))])])],8,ye))),128))]),c.value.length===0&&!p.value?(n(),D(R,{key:0,description:"Không có phản ánh có hình ảnh"})):x("",!0)]),r(O,{modelValue:g.value,"onUpdate:modelValue":a[2]||(a[2]=e=>g.value=e),title:"Xem hình ảnh",width:"800px"},{default:h(()=>[y.value?(n(),D(oe,{key:0,images:y.value.images},null,8,["images"])):x("",!0)]),_:1},8,["modelValue"])])}}},Oe=W(be,[["__scopeId","data-v-87830d1b"]]);export{Oe as default};
