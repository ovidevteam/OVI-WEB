import{_ as I,u as Q,r as v,a as F,c as d,b as l,d as o,w as s,e as z,E as A,f as G,g as H,o as m,h as M,i as P,j as p,k as T,l as K,m as j,n as X,p as i,q as Y,s as J,t as D,v as O,x as W,y as h,z as Z}from"./index-WXSJfKjD.js";/* empty css                    */const ee="/images/logo-footer.png",oe={class:"login-card"},le={class:"login-footer"},se={key:0},te={class:"forgot-desc"},ae={key:1,class:"forgot-success"},ne={class:"success-icon"},re={key:0},ie={key:1},ue={key:0,class:"demo-accounts"},de={class:"demo-list"},me={__name:"Login",setup(pe){const S=H(),x=Q(),V=v(null),a=F({username:"",password:"",remember:!1}),N={username:[{required:!0,message:"Vui lòng nhập tên đăng nhập",trigger:"blur"}],password:[{required:!0,message:"Vui lòng nhập mật khẩu",trigger:"blur"}]},w=async()=>{if(V.value)try{await V.value.validate();const r=await x.login({username:a.username,password:a.password});r.success?(h.success("Đăng nhập thành công!"),S.push("/dashboard")):h.error(r.message)}catch{}},k=(r,e)=>{a.username=r,a.password=e},g=v(!1),b=v(null),_=v(!1),f=v(!1),u=F({email:""}),R={email:[{required:!0,message:"Vui lòng nhập email",trigger:"blur"},{type:"email",message:"Email không hợp lệ",trigger:"blur"}]},B=()=>{u.email="",f.value=!1,g.value=!0},L=async()=>{var r,e;if(b.value)try{await b.value.validate(),_.value=!0;const n=await Z.forgotPassword(u.email);n.success?(f.value=!0,h.success(n.message||"Email đã được gửi thành công!")):h.error(n.message||"Gửi email thất bại. Vui lòng thử lại."),_.value=!1}catch(n){_.value=!1,h.error(((e=(r=n.response)==null?void 0:r.data)==null?void 0:e.message)||n.message||"Có lỗi xảy ra. Vui lòng thử lại.")}},U=()=>{g.value=!1,u.email="",f.value=!1};return(r,e)=>{const n=P,c=M,$=X,y=Y,E=A,C=J,q=G;return m(),d("div",oe,[e[21]||(e[21]=l("div",{class:"login-header"},[l("div",{class:"login-logo"},[l("img",{src:ee,alt:"BV Y Hà Nội",class:"login-logo-img"})]),l("p",{class:"login-subtitle"},"Hệ thống Quản lý Phản ánh")],-1)),o(E,{ref_key:"formRef",ref:V,model:a,rules:N,class:"login-form",onSubmit:z(w,["prevent"])},{default:s(()=>[o(c,{prop:"username"},{default:s(()=>[o(n,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=t=>a.username=t),placeholder:"Tên đăng nhập",size:"large","prefix-icon":p(T),autocomplete:"username"},null,8,["modelValue","prefix-icon"])]),_:1}),o(c,{prop:"password"},{default:s(()=>[o(n,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=t=>a.password=t),type:"password",placeholder:"Mật khẩu",size:"large","prefix-icon":p(j),"show-password":"",autocomplete:"current-password",onKeyup:K(w,["enter"])},null,8,["modelValue","prefix-icon"])]),_:1}),o(c,null,{default:s(()=>[o($,{modelValue:a.remember,"onUpdate:modelValue":e[2]||(e[2]=t=>a.remember=t)},{default:s(()=>[...e[10]||(e[10]=[i("Ghi nhớ đăng nhập",-1)])]),_:1},8,["modelValue"])]),_:1}),o(c,null,{default:s(()=>[o(y,{type:"primary",size:"large",class:"login-button",loading:p(x).loading,onClick:w},{default:s(()=>[...e[11]||(e[11]=[i(" Đăng nhập ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),l("div",le,[l("a",{href:"#",class:"forgot-password",onClick:z(B,["prevent"])},"Quên mật khẩu?")]),o(q,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=t=>g.value=t),title:"Quên mật khẩu",width:"420px",class:"forgot-dialog","close-on-click-modal":!1,"append-to-body":"",modal:!0},{footer:s(()=>[f.value?(m(),d("div",ie,[o(y,{type:"primary",onClick:U},{default:s(()=>[...e[19]||(e[19]=[i(" Quay lại đăng nhập ",-1)])]),_:1})])):(m(),d("div",re,[o(y,{onClick:e[4]||(e[4]=t=>g.value=!1)},{default:s(()=>[...e[17]||(e[17]=[i("Hủy",-1)])]),_:1}),o(y,{type:"primary",onClick:L,loading:_.value},{default:s(()=>[...e[18]||(e[18]=[i(" Gửi yêu cầu ",-1)])]),_:1},8,["loading"])]))]),default:s(()=>[f.value?(m(),d("div",ae,[l("div",ne,[o(C,{size:48,color:"#10b981"},{default:s(()=>[o(p(O))]),_:1})]),e[15]||(e[15]=l("h3",null,"Đã gửi email!",-1)),l("p",null,[e[13]||(e[13]=i("Vui lòng kiểm tra hộp thư ",-1)),l("strong",null,W(u.email),1),e[14]||(e[14]=i(" và làm theo hướng dẫn để khôi phục mật khẩu.",-1))]),e[16]||(e[16]=l("p",{class:"note"},"Nếu không thấy email, hãy kiểm tra thư mục Spam.",-1))])):(m(),d("div",se,[l("p",te,[o(C,{size:20,class:"forgot-icon"},{default:s(()=>[o(p(D))]),_:1}),e[12]||(e[12]=i(" Nhập email đăng ký, chúng tôi sẽ gửi link khôi phục mật khẩu. ",-1))]),o(E,{ref_key:"forgotFormRef",ref:b,model:u,rules:R,"label-position":"top"},{default:s(()=>[o(c,{prop:"email",label:"Email"},{default:s(()=>[o(n,{modelValue:u.email,"onUpdate:modelValue":e[3]||(e[3]=t=>u.email=t),placeholder:"example@bvyhanoi.vn",size:"large","prefix-icon":p(D)},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1},8,["model"])]))]),_:1},8,["modelValue"]),(m(),d("div",ue,[e[20]||(e[20]=l("p",{class:"demo-title"},"Demo Accounts:",-1)),l("div",de,[l("span",{onClick:e[6]||(e[6]=t=>k("admin","admin123"))},"Admin"),l("span",{onClick:e[7]||(e[7]=t=>k("leader","leader123"))},"Lãnh đạo"),l("span",{onClick:e[8]||(e[8]=t=>k("receiver","receiver123"))},"Tiếp nhận"),l("span",{onClick:e[9]||(e[9]=t=>k("handler","handler123"))},"Xử lý")])]))])}}},ce=I(me,[["__scopeId","data-v-37380e09"]]);export{ce as default};
