import{_ as ut,u as mt,r as h,a as M,B as _t,c as T,b as n,d as e,w as o,ad as vt,s as ft,x as d,W as yt,Z as Tt,A as C,a0 as bt,f as kt,y as A,D as Nt,o as m,ae as xt,C as Vt,L as Bt,J as j,K,a1 as St,q as Ct,j as v,a4 as wt,p as _,aq as Pt,ar as $,as as Ht,H as It,at as Dt,N as Et,P as At,au as Rt,Q as Lt,av as zt,e as Ft,aw as qt,X as G,ax as Ut,aj as Xt,al as Mt,E as jt,h as Kt,i as $t}from"./index-CEoFeFsB.js";/* empty css                   *//* empty css                         *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                        *//* empty css                    *//* empty css                *//* empty css               *//* empty css                             */const Gt={class:"feedback-ratings"},Jt={class:"content-card filter-card"},Ot={class:"stats-grid"},Qt={class:"stat-card"},Wt={class:"stat-icon total"},Zt={class:"stat-info"},Yt={class:"stat-value"},tn={class:"stat-card"},nn={class:"stat-icon pending"},en={class:"stat-info"},an={class:"stat-value"},on={class:"stat-card"},ln={class:"stat-icon rated"},sn={class:"stat-info"},dn={class:"stat-value"},cn={class:"stat-card"},rn={class:"stat-icon avg"},hn={class:"stat-info"},gn={class:"stat-value"},pn={class:"content-card"},un={class:"content-text"},mn={class:"doctor-cell"},_n={class:"doctor-name-text"},vn={key:1,class:"no-rating"},fn={class:"pagination-wrapper"},yn={key:0,class:"rating-dialog-content"},Tn={class:"feedback-info-section"},bn={class:"feedback-info-grid"},kn={class:"info-item"},Nn={class:"info-value"},xn={class:"info-item"},Vn={class:"info-value"},Bn={class:"info-item full-width"},Sn={class:"info-value"},Cn={class:"doctor-info-section"},wn={class:"doctor-profile"},Pn={class:"doctor-profile-info"},Hn={class:"doctor-name"},In={class:"doctor-dept"},Dn={key:0,class:"process-history-section"},En={class:"section-title"},An={class:"timeline-content"},Rn={class:"timeline-header"},Ln={class:"timeline-handler"},zn={class:"timeline-note"},Fn={class:"rating-form-section"},qn={class:"rating-stars"},Un={__name:"FeedbackRatings",setup(Xn){mt();const w=h(!1),P=h(!1),b=h([]),R=h(0),H=h(1),I=h(10),k=h(null),N=h(null),D=h([]),J=h([{id:1,name:"Nội khoa"},{id:2,name:"Ngoại khoa"},{id:3,name:"Da liễu"},{id:4,name:"Sản khoa"},{id:5,name:"Nhi khoa"}]),g=M({total:45,pending:8,rated:37,avgRating:4.2}),x=h(!1),r=h(null),E=h(null),p=M({rating:0,comment:""}),O={rating:[{required:!0,message:"Vui lòng chọn số sao đánh giá",trigger:"change"},{type:"number",min:1,max:5,message:"Đánh giá từ 1-5 sao",trigger:"change"}]},u=[{id:1,code:"PA-2024-001",content:"Thời gian chờ khám quá lâu, bệnh nhân phải đợi hơn 2 tiếng",doctorId:101,doctorName:"BS. Nguyễn Văn A",departmentId:1,departmentName:"Nội khoa",completedDate:"20/11/2024",rating:4,comment:"Bác sĩ xử lý tốt, giải quyết nhanh chóng",processHistory:[{date:"18/11/2024 08:30",handler:"Nguyễn Văn Tiếp Nhận",action:"Tiếp nhận",note:"Tiếp nhận phản ánh từ hotline, chuyển phòng Nội khoa xử lý"},{date:"18/11/2024 14:00",handler:"BS. Nguyễn Văn A",action:"Đang xử lý",note:"Đã xác minh tình trạng, đang điều phối lại lịch khám"},{date:"19/11/2024 09:15",handler:"BS. Nguyễn Văn A",action:"Xử lý xong",note:"Đã tăng cường nhân viên, giảm thời gian chờ. Liên hệ bệnh nhân xin lỗi và hẹn khám lại miễn phí"},{date:"20/11/2024 10:00",handler:"Trưởng khoa Nội",action:"Hoàn thành",note:"Xác nhận đã xử lý xong, bệnh nhân hài lòng"}]},{id:2,code:"PA-2024-002",content:"Nhân viên lễ tân thiếu thân thiện với bệnh nhân ca sáng",doctorId:102,doctorName:"BS. Trần Thị B",departmentId:2,departmentName:"Ngoại khoa",completedDate:"21/11/2024",rating:null,comment:null,processHistory:[{date:"19/11/2024 10:00",handler:"Trần Thị Tiếp Nhận",action:"Tiếp nhận",note:"Tiếp nhận từ hộp thư góp ý"},{date:"19/11/2024 15:30",handler:"BS. Trần Thị B",action:"Đang xử lý",note:"Xác nhận sự việc, đã làm việc với nhân viên liên quan"},{date:"21/11/2024 08:00",handler:"BS. Trần Thị B",action:"Hoàn thành",note:"Đã nhắc nhở nhân viên, bổ sung đào tạo kỹ năng giao tiếp"}]},{id:3,code:"PA-2024-003",content:"Khen ngợi bác sĩ điều trị nhiệt tình, chuyên nghiệp",doctorId:103,doctorName:"BS. Lê Văn C",departmentId:3,departmentName:"Da liễu",completedDate:"22/11/2024",rating:5,comment:"Xuất sắc!",processHistory:[{date:"21/11/2024 14:00",handler:"Lê Văn Tiếp Nhận",action:"Tiếp nhận",note:"Tiếp nhận lời khen từ bệnh nhân qua hotline"},{date:"22/11/2024 09:00",handler:"BS. Lê Văn C",action:"Hoàn thành",note:"Cảm ơn phản hồi tích cực. Đã ghi nhận vào hồ sơ thi đua"}]},{id:4,code:"PA-2024-004",content:"Phòng khám thiếu sạch sẽ, cần cải thiện vệ sinh",doctorId:104,doctorName:"BS. Phạm Thị D",departmentId:4,departmentName:"Sản khoa",completedDate:"23/11/2024",rating:null,comment:null,processHistory:[{date:"21/11/2024 16:00",handler:"Phạm Văn Tiếp Nhận",action:"Tiếp nhận",note:"Tiếp nhận phản ánh trực tiếp tại quầy"},{date:"22/11/2024 08:00",handler:"BS. Phạm Thị D",action:"Đang xử lý",note:"Đã kiểm tra thực tế, phối hợp bộ phận vệ sinh"},{date:"22/11/2024 17:00",handler:"BS. Phạm Thị D",action:"Xử lý xong",note:"Đã vệ sinh toàn bộ khu vực, tăng tần suất dọn dẹp"},{date:"23/11/2024 09:00",handler:"Trưởng khoa Sản",action:"Hoàn thành",note:"Đã nghiệm thu, đạt yêu cầu"}]},{id:5,code:"PA-2024-005",content:"Cơ sở vật chất xuống cấp, máy lạnh không hoạt động",doctorId:105,doctorName:"BS. Hoàng Văn E",departmentId:5,departmentName:"Nhi khoa",completedDate:"24/11/2024",rating:3,comment:"Xử lý ổn",processHistory:[{date:"22/11/2024 09:00",handler:"Hoàng Văn Tiếp Nhận",action:"Tiếp nhận",note:"Tiếp nhận phản ánh qua email"},{date:"22/11/2024 14:00",handler:"BS. Hoàng Văn E",action:"Đang xử lý",note:"Đã báo cáo phòng kỹ thuật, đợi sửa chữa"},{date:"24/11/2024 11:00",handler:"BS. Hoàng Văn E",action:"Hoàn thành",note:"Máy lạnh đã được sửa chữa và hoạt động bình thường"}]},{id:6,code:"PA-2024-006",content:"Thái độ phục vụ của y tá chưa tốt trong giờ trưa",doctorId:101,doctorName:"BS. Nguyễn Văn A",departmentId:1,departmentName:"Nội khoa",completedDate:"25/11/2024",rating:null,comment:null,processHistory:[{date:"23/11/2024 13:30",handler:"Nguyễn Thị Tiếp Nhận",action:"Tiếp nhận",note:"Tiếp nhận từ hotline"},{date:"24/11/2024 08:00",handler:"BS. Nguyễn Văn A",action:"Đang xử lý",note:"Đã xác minh với y tá ca trực, ghi nhận sự việc"},{date:"25/11/2024 09:00",handler:"BS. Nguyễn Văn A",action:"Hoàn thành",note:"Đã nhắc nhở và yêu cầu y tá viết bản kiểm điểm"}]},{id:7,code:"PA-2024-007",content:"Bác sĩ giải thích rõ ràng về tình trạng bệnh và phác đồ điều trị",doctorId:102,doctorName:"BS. Trần Thị B",departmentId:2,departmentName:"Ngoại khoa",completedDate:"26/11/2024",rating:5,comment:"Rất hài lòng với cách giải thích của bác sĩ",processHistory:[{date:"25/11/2024 10:00",handler:"Trần Văn Tiếp Nhận",action:"Tiếp nhận",note:"Tiếp nhận lời khen từ bệnh nhân"},{date:"26/11/2024 08:00",handler:"BS. Trần Thị B",action:"Hoàn thành",note:"Cảm ơn phản hồi. Ghi nhận thành tích"}]},{id:8,code:"PA-2024-008",content:"Phòng chờ quá đông, không đủ ghế ngồi cho bệnh nhân",doctorId:103,doctorName:"BS. Lê Văn C",departmentId:3,departmentName:"Da liễu",completedDate:"27/11/2024",rating:null,comment:null,processHistory:[{date:"25/11/2024 14:00",handler:"Lê Thị Tiếp Nhận",action:"Tiếp nhận",note:"Tiếp nhận phản ánh trực tiếp"},{date:"26/11/2024 09:00",handler:"BS. Lê Văn C",action:"Đang xử lý",note:"Đã khảo sát thực tế, đề xuất bổ sung ghế"},{date:"27/11/2024 10:00",handler:"BS. Lê Văn C",action:"Hoàn thành",note:"Đã bổ sung 10 ghế ngồi, sắp xếp lại không gian chờ"}]}],V=async()=>{w.value=!0;try{await new Promise(i=>setTimeout(i,500));let l=[...u];k.value==="pending"?l=l.filter(i=>!i.rating):k.value==="rated"&&(l=l.filter(i=>i.rating)),N.value&&(l=l.filter(i=>i.departmentId===N.value)),b.value=l,R.value=l.length,g.total=u.length,g.pending=u.filter(i=>!i.rating).length,g.rated=u.filter(i=>i.rating).length;const t=u.filter(i=>i.rating);g.avgRating=t.length>0?(t.reduce((i,c)=>i+c.rating,0)/t.length).toFixed(1):0}catch(l){A.error("Lỗi khi tải dữ liệu"),console.error(l)}finally{w.value=!1}},Q=()=>{k.value=null,N.value=null,D.value=[],V()},W=l=>{H.value=l,V()},Z=l=>{I.value=l,V()},Y=l=>({"Tiếp nhận":"primary","Đang xử lý":"warning","Xử lý xong":"success","Hoàn thành":"success"})[l]||"info",tt=l=>({"Tiếp nhận":"info","Đang xử lý":"warning","Xử lý xong":"success","Hoàn thành":"success"})[l]||"",L=l=>{r.value={...l},p.rating=l.rating||0,p.comment=l.comment||"",x.value=!0},nt=async()=>{if(E.value)try{await E.value.validate(),P.value=!0,await new Promise(c=>setTimeout(c,800));const l=b.value.findIndex(c=>c.id===r.value.id);l!==-1&&(b.value[l].rating=p.rating,b.value[l].comment=p.comment);const t=u.findIndex(c=>c.id===r.value.id);t!==-1&&(u[t].rating=p.rating,u[t].comment=p.comment),A.success(r.value.rating?"Cập nhật đánh giá thành công!":"Đánh giá thành công!"),x.value=!1,g.pending=u.filter(c=>!c.rating).length,g.rated=u.filter(c=>c.rating).length;const i=u.filter(c=>c.rating);g.avgRating=i.length>0?(i.reduce((c,y)=>c+y.rating,0)/i.length).toFixed(1):0}catch(l){l!==!1&&A.error("Có lỗi xảy ra. Vui lòng thử lại.")}finally{P.value=!1}};return _t(()=>{V()}),(l,t)=>{var X;const i=Bt,c=Vt,y=xt,et=St,B=Ct,at=vt,S=ft,f=Et,ot=At,z=Rt,F=Lt,q=zt,lt=Nt,it=bt,st=Mt,dt=Xt,U=Kt,ct=$t,rt=jt,ht=kt,gt=Tt;return m(),T("div",Gt,[t[24]||(t[24]=n("div",{class:"page-header"},[n("h3",{class:"page-title"},"Đánh giá Bác sĩ sau xử lý"),n("p",{class:"page-desc"},"Đánh giá chất lượng xử lý của bác sĩ sau khi phản ánh được hoàn thành")],-1)),n("div",Jt,[e(at,{gutter:16},{default:o(()=>[e(y,{xs:24,sm:8,md:6},{default:o(()=>[e(c,{modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=a=>k.value=a),placeholder:"Trạng thái đánh giá",clearable:"",style:{width:"100%"}},{default:o(()=>[e(i,{label:"Chưa đánh giá",value:"pending"}),e(i,{label:"Đã đánh giá",value:"rated"})]),_:1},8,["modelValue"])]),_:1}),e(y,{xs:24,sm:8,md:6},{default:o(()=>[e(c,{modelValue:N.value,"onUpdate:modelValue":t[1]||(t[1]=a=>N.value=a),placeholder:"Phòng ban",clearable:"",style:{width:"100%"}},{default:o(()=>[(m(!0),T(j,null,K(J.value,a=>(m(),C(i,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(y,{xs:24,sm:8,md:6},{default:o(()=>[e(et,{modelValue:D.value,"onUpdate:modelValue":t[2]||(t[2]=a=>D.value=a),type:"daterange","range-separator":"-","start-placeholder":"Từ ngày","end-placeholder":"Đến ngày",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(y,{xs:24,sm:24,md:6},{default:o(()=>[e(B,{type:"primary",onClick:V,icon:v(wt)},{default:o(()=>[...t[9]||(t[9]=[_("Tìm kiếm",-1)])]),_:1},8,["icon"]),e(B,{onClick:Q,icon:v(Pt)},{default:o(()=>[...t[10]||(t[10]=[_("Đặt lại",-1)])]),_:1},8,["icon"])]),_:1})]),_:1})]),n("div",Ot,[n("div",Qt,[n("div",Wt,[e(S,null,{default:o(()=>[e(v($))]),_:1})]),n("div",Zt,[n("span",Yt,d(g.total),1),t[11]||(t[11]=n("span",{class:"stat-label"},"Tổng PA hoàn thành",-1))])]),n("div",tn,[n("div",nn,[e(S,null,{default:o(()=>[e(v(Ht))]),_:1})]),n("div",en,[n("span",an,d(g.pending),1),t[12]||(t[12]=n("span",{class:"stat-label"},"Chờ đánh giá",-1))])]),n("div",on,[n("div",ln,[e(S,null,{default:o(()=>[e(v(It))]),_:1})]),n("div",sn,[n("span",dn,d(g.rated),1),t[13]||(t[13]=n("span",{class:"stat-label"},"Đã đánh giá",-1))])]),n("div",cn,[n("div",rn,[e(S,null,{default:o(()=>[e(v(Dt))]),_:1})]),n("div",hn,[n("span",gn,d(g.avgRating),1),t[14]||(t[14]=n("span",{class:"stat-label"},"Điểm TB",-1))])])]),n("div",pn,[t[15]||(t[15]=n("div",{class:"content-card-header"},[n("h4",{class:"content-card-title"},"Danh sách phản ánh đã hoàn thành")],-1)),yt((m(),C(lt,{data:b.value,stripe:"",onRowClick:L,class:"rating-table",style:{width:"100%"}},{default:o(()=>[e(f,{prop:"code",label:"Mã PA",width:"130"}),e(f,{prop:"content",label:"Nội dung","min-width":"280"},{default:o(({row:a})=>[e(ot,{content:a.content,placement:"top","show-after":500},{default:o(()=>[n("span",un,d(a.content),1)]),_:2},1032,["content"])]),_:1}),e(f,{prop:"doctorName",label:"Bác sĩ","min-width":"150"},{default:o(({row:a})=>[n("div",mn,[e(z,{size:28,class:"doctor-avatar"},{default:o(()=>{var s;return[_(d((s=a.doctorName)==null?void 0:s.charAt(0)),1)]}),_:2},1024),n("span",_n,d(a.doctorName||"-"),1)])]),_:1}),e(f,{prop:"departmentName",label:"Phòng","min-width":"100"}),e(f,{prop:"completedDate",label:"Ngày HT",width:"105"}),e(f,{prop:"ratingStatus",label:"Trạng thái",width:"110"},{default:o(({row:a})=>[e(F,{type:a.rating?"success":"warning",size:"small"},{default:o(()=>[_(d(a.rating?"Đã đánh giá":"Chờ đánh giá"),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"rating",label:"Đánh giá",width:"140"},{default:o(({row:a})=>[a.rating?(m(),C(q,{key:0,modelValue:a.rating,"onUpdate:modelValue":s=>a.rating=s,disabled:"","show-score":"","text-color":"#ff9900",size:"small"},null,8,["modelValue","onUpdate:modelValue"])):(m(),T("span",vn,"Chưa có"))]),_:1}),e(f,{label:"Thao tác",width:"100",fixed:"right"},{default:o(({row:a})=>[e(B,{type:"primary",icon:a.rating?v(qt):v($),size:"small",onClick:Ft(s=>L(a),["stop"])},{default:o(()=>[_(d(a.rating?"Sửa":"Đánh giá"),1)]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[gt,w.value]]),n("div",fn,[e(it,{"current-page":H.value,"onUpdate:currentPage":t[3]||(t[3]=a=>H.value=a),"page-size":I.value,"onUpdate:pageSize":t[4]||(t[4]=a=>I.value=a),"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",total:R.value,onSizeChange:Z,onCurrentChange:W},null,8,["current-page","page-size","total"])])]),e(ht,{modelValue:x.value,"onUpdate:modelValue":t[8]||(t[8]=a=>x.value=a),title:(X=r.value)!=null&&X.rating?"Chỉnh sửa đánh giá":"Đánh giá Bác sĩ",width:"700px",class:"rating-dialog","close-on-click-modal":!1,draggable:"",top:"5vh"},{footer:o(()=>[e(B,{onClick:t[7]||(t[7]=a=>x.value=!1)},{default:o(()=>[...t[23]||(t[23]=[_("Hủy",-1)])]),_:1}),e(B,{type:"primary",onClick:nt,loading:P.value},{default:o(()=>{var a;return[_(d((a=r.value)!=null&&a.rating?"Cập nhật":"Lưu đánh giá"),1)]}),_:1},8,["loading"])]),default:o(()=>{var a;return[r.value?(m(),T("div",yn,[n("div",Tn,[t[19]||(t[19]=n("h4",{class:"section-title"},"Thông tin phản ánh",-1)),n("div",bn,[n("div",kn,[t[16]||(t[16]=n("span",{class:"info-label"},"Mã PA:",-1)),n("span",Nn,d(r.value.code),1)]),n("div",xn,[t[17]||(t[17]=n("span",{class:"info-label"},"Phòng ban:",-1)),n("span",Vn,d(r.value.departmentName),1)]),n("div",Bn,[t[18]||(t[18]=n("span",{class:"info-label"},"Nội dung:",-1)),n("span",Sn,d(r.value.content),1)])])]),n("div",Cn,[t[20]||(t[20]=n("h4",{class:"section-title"},"Bác sĩ được đánh giá",-1)),n("div",wn,[e(z,{size:56,class:"doctor-profile-avatar"},{default:o(()=>{var s;return[_(d((s=r.value.doctorName)==null?void 0:s.charAt(0)),1)]}),_:1}),n("div",Pn,[n("span",Hn,d(r.value.doctorName),1),n("span",In,d(r.value.departmentName),1)])])]),(a=r.value.processHistory)!=null&&a.length?(m(),T("div",Dn,[n("h4",En,[e(S,null,{default:o(()=>[e(v(Ut))]),_:1}),t[21]||(t[21]=_(" Lịch sử xử lý ",-1))]),e(dt,null,{default:o(()=>[(m(!0),T(j,null,K(r.value.processHistory,(s,pt)=>(m(),C(st,{key:pt,type:Y(s.action),timestamp:s.date,placement:"top"},{default:o(()=>[n("div",An,[n("div",Rn,[e(F,{type:tt(s.action),size:"small"},{default:o(()=>[_(d(s.action),1)]),_:2},1032,["type"]),n("span",Ln,d(s.handler),1)]),n("div",zn,d(s.note),1)])]),_:2},1032,["type","timestamp"]))),128))]),_:1})])):G("",!0),n("div",Fn,[t[22]||(t[22]=n("h4",{class:"section-title"},"Đánh giá chất lượng xử lý",-1)),e(rt,{model:p,ref_key:"ratingFormRef",ref:E,rules:O,"label-position":"top"},{default:o(()=>[e(U,{label:"Đánh giá (1-5 sao)",prop:"rating"},{default:o(()=>[n("div",qn,[e(q,{modelValue:p.rating,"onUpdate:modelValue":t[5]||(t[5]=s=>p.rating=s),"show-score":"","show-text":"",texts:["Rất tệ","Tệ","Bình thường","Tốt","Rất tốt"],"text-color":"#ff9900",size:"large"},null,8,["modelValue"])])]),_:1}),e(U,{label:"Nhận xét",prop:"comment"},{default:o(()=>[e(ct,{modelValue:p.comment,"onUpdate:modelValue":t[6]||(t[6]=s=>p.comment=s),type:"textarea",rows:3,placeholder:"Nhập nhận xét về chất lượng xử lý của bác sĩ...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])])):G("",!0)]}),_:1},8,["modelValue","title"])])}}},te=ut(Un,[["__scopeId","data-v-576283f3"]]);export{te as default};
